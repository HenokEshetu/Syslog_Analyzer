# Syslog Analyzer

Syslog Analyzer is a modular, real-time security analytics platform designed to collect, analyze, correlate, and visualize syslog data from distributed infrastructure. It enables security teams to detect threats, investigate incidents, and monitor system health through a modern dashboard and automated alerting.

---

## Features

- **Distributed Syslog Collection**: Ingests syslog messages over UDP/TCP from multiple sources.
- **Real-Time Analysis**: Applies customizable detection rules to identify suspicious activity.
- **Correlation Engine**: Detects complex attack patterns (e.g., brute force, lateral movement, port scans).
- **Alerting**: Sends notifications via email and Slack for critical events.
- **Dashboard**: Interactive web UI for monitoring logs, alerts, and system statistics.
- **Extensible Rules**: YAML-based detection rules for easy customization.
- **Containerized Deployment**: Runs as Docker containers for easy setup and scaling.

---

## Architecture

```
+----------------+      +-------------+      +-------------+      +-------------+
| Syslog Sources | ---> |  Collector  | ---> |  Analyzer   | ---> |  Dashboard  |
+----------------+      +-------------+      +-------------+      +-------------+
                             |                    |                    |
                             |                    v                    v
                             |               +---------+         +-----------+
                             +-------------> | NATS MQ | <-----> | Postgres  |
                                             +---------+         +-----------+
```

- **Collector**: Receives syslog messages, parses, and publishes to NATS.
- **Analyzer**: Consumes messages, applies detection rules, stores logs/alerts in Postgres.
- **Correlation Engine**: Periodically analyzes logs for multi-step attack patterns.
- **Dashboard**: Visualizes logs, alerts, and statistics; provides search and filtering.

---

## Quick Start

### Prerequisites

- [Docker](https://www.docker.com/)
- [Docker Compose](https://docs.docker.com/compose/)

### 1. Clone the Repository

```bash
git clone https://github.com/HenokEshetu/Syslog_Analyzer.git
cd Syslog_Analyzer
```

### 2. Build and Start the Stack

```bash
docker-compose up --build
```

This will start the following services:

- `postgres`: Stores logs and alerts.
- `nats`: Message broker for syslog events.
- `collector`: Listens for syslog messages on UDP/TCP 514.
- `analyzer`: Applies detection rules and stores results.
- `correlator`: Runs advanced correlation logic.
- `dashboard`: Web UI at [http://localhost:5000](http://localhost:5000).

### 3. Send Syslog Messages

Configure your devices or use `logger` to send test messages:

```bash
logger -n 127.0.0.1 -P 514 -d "Test syslog message from host"
```

---

## Configuration

### Detection Rules

Detection rules are defined in YAML files (see `config/rules.yaml` for each component):

```yaml
- id: "SSH_BRUTEFORCE"
  name: "SSH Bruteforce Attempt"
  description: "Multiple failed SSH login attempts from the same source"
  severity: "high"
  tags: ["ssh", "bruteforce", "authentication"]
  condition: "Failed password"
  window: 300
  threshold: 10
  actions: ["email", "slack"]
```

- **condition**: Regex or string to match in log messages.
- **window/threshold**: For rate-based rules (e.g., 10 failures in 5 minutes).
- **actions**: Notification channels.

### Service Configuration

Each component reads its config from `/config/config.yaml`. Example:

```yaml
nats_url: "nats://nats:4222"
db_host: "postgres"
db_port: 5432
db_user: "syslog_analyzer"
db_password: "Passwrd#123"
db_name: "syslog"
alert_email: "security@example.com"
alert_slack_webhook: "https://hooks.slack.com/services/XXXXXXXXX"
rules_path: "/config/rules.yaml"
```

---

## Dashboard

- **URL**: [http://localhost:5000](http://localhost:5000)
- **Features**:
  - Log volume and alert statistics
  - Recent alerts and log explorer with pagination
  - Timeline charts for log and event trends
  - Top source IPs for alerts

---

## Extending & Customizing

- **Add Detection Rules**: Edit the appropriate `rules.yaml` file and restart the analyzer.
- **Integrate New Alert Channels**: Extend the analyzer's alerting logic (see `detector.py`).
- **Custom Correlation**: Implement new patterns in `correlation_engine.py`.

---

## Development

### Python Components

```bash
cd analyzer
pip install -r requirements.txt
python detector.py
```

### Go Collector

```bash
cd collector
go build -o collector
./collector
```

---

## Database Schema

- **syslog_messages**: Stores all ingested syslog events.
- **alerts**: Stores alerts generated by detection rules.
- **detection_rules**: Metadata for rules.
- **correlation_alerts**: Alerts from the correlation engine.

---

## Security & Best Practices

- Change default passwords in `config.yaml` and `docker-compose.yml`.
- Restrict syslog input ports as needed.
- Use secure channels for alerting (e.g., Slack webhooks, SMTP).

---

## License

MIT License. See [LICENSE](LICENSE) for details.

---

## Acknowledgments

- [NATS](https://nats.io/) for lightweight messaging.
- [PostgreSQL](https://www.postgresql.org/) for robust storage.
- [Bootstrap](https://getbootstrap.com/) and [Chart.js](https://www.chartjs.org/) for the dashboard UI.

---

## Contact

For questions, issues, or contributions, please open an issue or contact the maintainers.
